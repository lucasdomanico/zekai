<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script src="life.z_files/codemirror.js"></script>
<script src="life.z_files/simple.js"></script>
<script src="life.z_files/matchbrackets.js"></script>
<script src="life.z_files/closebrackets.js"></script>
<script src="life.z_files/comment.js"></script>
<script src="life.z_files/active-line.js"></script>
<script src="life.z_files/match-highlighter.js"></script>
<link rel="stylesheet" href="life.z_files/codemirror.css">
<link rel="stylesheet" href="life.z_files/index.css">
<title>life.z</title></head>

<body style="margin: 0px; padding: 0px; background: rgb(34, 34, 34);">

<script>

// let keywords = 'async|await|import|ret|if|for|else|iif|instanceof|new|break|continue'

CodeMirror.defineSimpleMode('zekai', {
    start: [

        { token: "banned",              regex: /^[ ]+(let) /, sol:true },


        { token: ["normal", "keyword"], regex: /^([ ]+[a-z_][A-Za-z_\d]*) (\=|\+\=)/, sol:true },
        { token: "keyword",             regex: /^[ ]+(async|await|import|ret|if|for|else|iif|new) /, sol:true },
        { token: ["normal", "let"],     regex: /^([ ]+)([a-z_][A-Za-z_\d]*) /, sol:true },

        // { token: "let",                 regex: /^[ ]+(\i\f)|([a-z_\d]+) /, sol:true },

        { token: "string",  regex: /'(?:[^\\]|\\.)*?(?:'|$)/ },
        { token: "number",  regex: /0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i, },
        { token: "keyword", regex: /(?:async|await|import|ret|if|for|else|iif|instanceof|new|break|continue)\b/ },

        { token: "keyword", regex: /\&\&/ },
        { token: "keyword", regex: /\|\|/ },
        { token: "bitwise", regex: /\|/ },
        { token: "bitwise", regex: /\^/ },
        { token: "bitwise", regex: /\&/ },
        { token: "bitwise", regex: /\<\</ },
        { token: "bitwise", regex: /\>\>\>/ },
        { token: "bitwise", regex: /\>\>/ },
        { token: "bitwise", regex: /\~/ },

        { token: "banned", regex: /(\!\=\=)|(\=\=\=)/ },

        { token: "keyword", regex: /[-+\/*=<>!%\[\]\{\}]+/ },
        { token: "par",     regex: /\@/ },
        // { token: "keyword", regex: /\||\[|\]/ },
        { token: "keyword", regex: /\\/ },
        { token: "par",     regex: /(?:true|false)\b/ },
        { token: "std",     regex: /(?:print|range|clone)\b/ },
        { token: "par",     regex: /\(|\)/ },
        { token: "comment", regex: /\#.*/ },
        { token: "type",    regex: /^[A-Z][A-Za-z$\d]+/ },
        { token: "type",    regex: /(?:bool|num|int|void|fun|str|array|union|extends|map|tuple)\b/ },
        { token: "generic", regex: /^[A-Z]/ },
        { token: "evil",    regex: /(?:null|undefined|any|typeof|let)\b/ },
        { token: "banned",  regex: /[\;\?]/ },
        { token: "comma",   regex: /[\,\:]/ },
        { token: "normal",  regex: /^[a-z$][\w$]*/ },
        { token: "dot",     regex: /\./ },
        { token: "tab",     regex: /^[ ]+$/, sol:true },
        { token: "excess",  regex: /^[ ]+$/ },
    ],
    meta: {
        dontIndentStates: ["comment"],
        lineComment: "#"
    }
})

let codeMirror = CodeMirror(document.body, {
    value: '',
    mode:  "zekai",
    lineNumbers: true,
    indentUnit: 4,
    indentWithTabs: false,
    smartIndent: true,
    matchBrackets: true,
    autoCloseBrackets: true,
    styleActiveLine: true,

    // highlightSelectionMatches: {
    //     showToken: true
    // },

    highlightSelectionMatches: {
        minChars: 2,
        delay: 100,
        // wordsOnly: true,
        // annotateScrollbar: false,
        // showToken: false,
        // trim: true
    },

    viewportMargin: 10000, // otherwise browser's find (and replace?) doesn't works

    extraKeys: {
        Tab: (cm) => {
            if(cm.getMode().name === 'null') {
                cm.execCommand('insertTab')
            }
            else {
                if(cm.somethingSelected()) {
                    cm.execCommand('indentMore')
                }
                else {
                    cm.execCommand('insertSoftTab')
                }
            }
        },
        Backspace: (cm) => {
            if(!cm.somethingSelected()) {
                let cursorsPos = cm.listSelections().map((selection) => selection.anchor)
                let indentUnit = cm.options.indentUnit
                let shouldDelChar = false
                for(let cursorIndex in cursorsPos) {
                    let cursorPos = cursorsPos[cursorIndex]
                    let indentation = cm.getStateAfter(cursorPos.line).indented
                    if(!(indentation !== 0 &&
                        cursorPos.ch <= indentation &&
                        cursorPos.ch % indentUnit === 0)) {
                        shouldDelChar = true;
                    }
                }
                if(!shouldDelChar) {
                    cm.execCommand('indentLess')
                }
                else {
                    cm.execCommand('delCharBefore')
                }
            }
            else {
                cm.execCommand('delCharBefore')
            }
        },
        'Shift-Tab': (cm) => cm.execCommand('indentLess'),
    }
})

document.title = window.location.href.split('/').at(-1)

if(codeMirror.onsave !== undefined) {
    alert('error')
}
codeMirror.onsave = () => {
    alert(codeMirror.getValue())
}

document.onkeydown = function(e) {
    if(e.ctrlKey && e.which === 83) {
        e.preventDefault()
        codeMirror.onsave()
        return false
    }
    if(e.ctrlKey && e.which === 191) {
        e.preventDefault()
        codeMirror.toggleComment({ indent:true })
        return false
    }
}

</script><div class="CodeMirror cm-s-default CodeMirror-focused" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 48px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; min-height: 1em; outline: none;" wrap="off" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; visibility: hidden; display: block; bottom: 0px;"><div style="min-width: 1px; height: 1373px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; visibility: hidden;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 32px; margin-bottom: 0px; border-right-width: 50px; min-height: 1373px; min-width: 376.5px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: none;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>89</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 16px; top: 0px; height: 15.3333px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -32px; width: 32px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-string">'std'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-std">range</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">width</span> <span class="cm-number">200</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">height</span> <span class="cm-number">200</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Grid</span> <span class="cm-type">array</span><span class="cm-par">(</span><span class="cm-type">array</span><span class="cm-par">(</span><span class="cm-type">bool</span><span class="cm-par">))</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Grid</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">init_grid</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-std">range</span><span class="cm-par">(</span><span class="cm-normal">height</span><span class="cm-par">)</span><span class="cm-dot">.</span><span class="cm-type">map</span><span class="cm-par">(</span><span class="cm-keyword">\</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-std">range</span><span class="cm-par">(</span><span class="cm-normal">width</span><span class="cm-par">)</span><span class="cm-dot">.</span><span class="cm-type">map</span><span class="cm-par">(</span><span class="cm-keyword">\</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">            <span class="cm-type">Math</span><span class="cm-dot">.</span><span class="cm-normal">random</span><span class="cm-par">()</span> <span class="cm-keyword">&gt;</span> <span class="cm-number">0.5</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Grid</span> <span class="cm-type">int</span> <span class="cm-type">int</span> <span class="cm-type">bool</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">at</span> <span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-normal">x</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">    if </span><span class="cm-normal">y</span> <span class="cm-keyword">&lt;</span> <span class="cm-number">0</span> <span class="cm-keyword">||</span> <span class="cm-normal">x</span> <span class="cm-keyword">&lt;</span> <span class="cm-number">0</span> <span class="cm-keyword">ret</span> <span class="cm-par">false</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">    if </span><span class="cm-normal">y</span> <span class="cm-keyword">&gt;=</span> <span class="cm-normal">height</span> <span class="cm-keyword">||</span> <span class="cm-normal">x</span> <span class="cm-keyword">&gt;=</span> <span class="cm-normal">width</span> <span class="cm-keyword">ret</span> <span class="cm-par">false</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">grid</span><span class="cm-keyword">[</span><span class="cm-normal">y</span><span class="cm-keyword">][</span><span class="cm-normal">x</span><span class="cm-keyword">]</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Grid</span> <span class="cm-type">Grid</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">step</span> <span class="cm-normal">grid</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">grid</span><span class="cm-dot">.</span><span class="cm-type">map</span><span class="cm-par">(</span><span class="cm-keyword">\</span><span class="cm-normal">row</span> <span class="cm-normal">y</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-normal">row</span><span class="cm-dot">.</span><span class="cm-type">map</span><span class="cm-par">(</span><span class="cm-keyword">\</span><span class="cm-normal">alive</span> <span class="cm-normal">x</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">            </span><span class="cm-let">atari</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">+</span> <span class="cm-number">0</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">+</span> <span class="cm-number">0</span> <span class="cm-normal">x</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">+</span> <span class="cm-number">0</span> <span class="cm-normal">x</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">-</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">+</span> <span class="cm-number">0</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">at</span><span class="cm-par">(</span><span class="cm-normal">grid</span> <span class="cm-normal">y</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span> <span class="cm-normal">x</span> <span class="cm-keyword">+</span> <span class="cm-number">1</span><span class="cm-par">)</span> <span class="cm-normal">atari</span> <span class="cm-keyword">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">alive</span> <span class="cm-keyword">&amp;&amp;</span> <span class="cm-normal">atari</span> <span class="cm-keyword">&lt;</span> <span class="cm-number">2</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">                ret </span><span class="cm-par">false</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">alive</span> <span class="cm-keyword">&amp;&amp;</span> <span class="cm-par">(</span><span class="cm-normal">atari</span> <span class="cm-keyword">==</span> <span class="cm-number">2</span> <span class="cm-keyword">||</span> <span class="cm-normal">atari</span> <span class="cm-keyword">==</span> <span class="cm-number">3</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">                ret </span><span class="cm-par">true</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if </span><span class="cm-normal">alive</span> <span class="cm-keyword">&amp;&amp;</span> <span class="cm-normal">atari</span> <span class="cm-keyword">&gt;</span> <span class="cm-number">3</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">                ret </span><span class="cm-par">false</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">            if !</span><span class="cm-normal">alive</span> <span class="cm-keyword">&amp;&amp;</span> <span class="cm-normal">atari</span> <span class="cm-keyword">==</span> <span class="cm-number">3</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">                ret </span><span class="cm-par">true</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">            <span class="cm-normal">alive</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Canvas</span> <span class="cm-type">HTMLCanvasElement</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Canvas</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">canvas</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">    </span><span class="cm-let">canvas</span> <span class="cm-normal">document</span><span class="cm-dot">.</span><span class="cm-normal">createElement</span><span class="cm-par">(</span><span class="cm-string">'canvas'</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">width</span> <span class="cm-keyword">=</span> <span class="cm-normal">width</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">54</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">height</span> <span class="cm-keyword">=</span> <span class="cm-normal">height</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">55</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">position</span> <span class="cm-keyword">=</span> <span class="cm-string">'absolute'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">56</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">top</span> <span class="cm-keyword">=</span> <span class="cm-string">'0'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">57</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">right</span> <span class="cm-keyword">=</span> <span class="cm-string">'1.5%'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">58</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">border</span> <span class="cm-keyword">=</span> <span class="cm-string">'2px solid black'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">59</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">width</span> <span class="cm-keyword">=</span> <span class="cm-string">'40%'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">60</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">style</span><span class="cm-dot">.</span><span class="cm-normal">imageRendering</span> <span class="cm-keyword">=</span> <span class="cm-string">'pixelated'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">61</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">document</span><span class="cm-dot">.</span><span class="cm-normal">body</span><span class="cm-dot">.</span><span class="cm-normal">append</span><span class="cm-par">(</span><span class="cm-normal">canvas</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">62</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">canvas</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">63</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">64</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Canvas</span> <span class="cm-type">void</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">65</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">animate</span> <span class="cm-normal">canvas</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">66</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">tick</span><span class="cm-par">(</span><span class="cm-normal">canvas</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">67</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">setTimeout</span><span class="cm-par">(</span><span class="cm-keyword">\\</span> <span class="cm-normal">animate</span><span class="cm-par">(</span><span class="cm-normal">canvas</span><span class="cm-par">)</span> <span class="cm-number">1000</span> <span class="cm-keyword">/</span> <span class="cm-number">60</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">68</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">69</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Canvas</span> <span class="cm-type">int</span> <span class="cm-type">int</span> <span class="cm-type">bool</span> <span class="cm-type">void</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">70</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">pixel</span> <span class="cm-normal">canvas</span> <span class="cm-normal">x</span> <span class="cm-normal">y</span> <span class="cm-normal">alive</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">71</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">    </span><span class="cm-let">c</span> <span class="cm-normal">canvas</span><span class="cm-dot">.</span><span class="cm-normal">getContext</span><span class="cm-par">(</span><span class="cm-string">'2d'</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">72</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">    if </span><span class="cm-normal">c</span> <span class="cm-keyword">instanceof</span> <span class="cm-type">CanvasRenderingContext2D</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">73</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-normal">c</span><span class="cm-dot">.</span><span class="cm-normal">fillStyle</span> <span class="cm-keyword">=</span> <span class="cm-keyword">iif</span> <span class="cm-normal">alive</span> <span class="cm-string">'yellow'</span> <span class="cm-string">'black'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">74</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-normal">c</span><span class="cm-dot">.</span><span class="cm-normal">fillRect</span><span class="cm-par">(</span><span class="cm-normal">x</span> <span class="cm-normal">y</span> <span class="cm-number">1</span> <span class="cm-number">1</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">75</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">76</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">grid</span> <span class="cm-normal">init_grid</span><span class="cm-par">()</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">77</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">78</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-type">Canvas</span> <span class="cm-type">void</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">79</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">tick</span> <span class="cm-normal">canvas</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">80</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">    grid</span><span class="cm-keyword"> =</span> <span class="cm-normal">step</span><span class="cm-par">(</span><span class="cm-normal">grid</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">81</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">grid</span><span class="cm-dot">.</span><span class="cm-normal">forEach</span><span class="cm-par">(</span><span class="cm-keyword">\</span><span class="cm-normal">row</span> <span class="cm-normal">y</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">82</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-normal">row</span><span class="cm-dot">.</span><span class="cm-normal">forEach</span><span class="cm-par">(</span><span class="cm-keyword">\</span><span class="cm-normal">alive</span> <span class="cm-normal">x</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">83</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">            <span class="cm-normal">pixel</span><span class="cm-par">(</span><span class="cm-normal">canvas</span> <span class="cm-normal">x</span> <span class="cm-normal">y</span> <span class="cm-normal">alive</span><span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">84</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">        <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">85</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-par">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">86</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">87</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-normal">main</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">88</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">    <span class="cm-normal">animate</span><span class="cm-par">(</span><span class="cm-normal">canvas</span><span class="cm-par">())</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -32px;" aria-hidden="true"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">89</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 50px; width: 1px; border-bottom: 0px solid transparent; top: 1373px;"></div><div class="CodeMirror-gutters" style="height: 1423px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;"></div></div></div></div>

<script>
document.body.style.background = '#222'
document.body.style.visibility = 'hidden'

let unload_handler = (e) => {
    e.preventDefault()
}

let title = window.location.href.split('/').at(-1)

let codemirror_value = `
main
    console.log('hi zekai!')
`
let codemirror_fetch = ''


        codemirror_value = "'std'\n    range\n\nwidth 200\nheight 200\n\nGrid array(array(bool))\n\nGrid\ninit_grid\n    range(height).map(\\\n        range(width).map(\\\n            Math.random() > 0.5\n        )\n    )\n\nGrid int int bool\nat grid y x\n    if y < 0 || x < 0 ret false\n    if y >= height || x >= width ret false\n    grid[y][x]\n\nGrid Grid\nstep grid\n    grid.map(\\row y\n        row.map(\\alive x\n            atari 0\n            if at(grid y - 1 x - 1) atari += 1\n            if at(grid y - 1 x + 0) atari += 1\n            if at(grid y - 1 x + 1) atari += 1\n            if at(grid y + 0 x - 1) atari += 1\n            if at(grid y + 0 x + 1) atari += 1\n            if at(grid y + 1 x - 1) atari += 1\n            if at(grid y + 1 x + 0) atari += 1\n            if at(grid y + 1 x + 1) atari += 1\n            if alive && atari < 2\n                ret false\n            if alive && (atari == 2 || atari == 3)\n                ret true\n            if alive && atari > 3\n                ret false\n            if !alive && atari == 3\n                ret true\n            alive\n        )\n    )\n\nCanvas HTMLCanvasElement\n\nCanvas\ncanvas\n    canvas document.createElement('canvas')\n    canvas.width = width\n    canvas.height = height\n    canvas.style.position = 'absolute'\n    canvas.style.top = '0'\n    canvas.style.right = '1.5%'\n    canvas.style.border = '2px solid black'\n    canvas.style.width = '40%'\n    canvas.style.imageRendering = 'pixelated'\n    document.body.append(canvas)\n    canvas\n\nCanvas void\nanimate canvas\n    tick(canvas)\n    setTimeout(\\\\ animate(canvas) 1000 / 60)\n\nCanvas int int bool void\npixel canvas x y alive\n    c canvas.getContext('2d')\n    if c instanceof CanvasRenderingContext2D\n        c.fillStyle = iif alive 'yellow' 'black'\n        c.fillRect(x y 1 1)\n\ngrid init_grid()\n\nCanvas void\ntick canvas\n    grid = step(grid)\n    grid.forEach(\\row y\n        row.forEach(\\alive x\n            pixel(canvas x y alive)\n        )\n    )\n\nmain\n    animate(canvas())\n"
        codemirror_fetch = 'http://localhost:777/' + "C:/@astor/@zekai/examples/life.z"
    

codeMirror.setValue(codemirror_value)
codeMirror.clearHistory()
codeMirror.on('change', () => {
    document.title  = '● ' + title
    window.addEventListener('beforeunload', unload_handler)
})
codeMirror.onsave = () => {
    document.title = title
    window.removeEventListener('beforeunload', unload_handler)
    sessionStorage.setItem('history', JSON.stringify(codeMirror.getDoc().getHistory()))
    let code = codeMirror.getValue()
    let arraybuf = new TextEncoder().encode(code)
    if(codemirror_fetch === '') {
        return
    }
    fetch(codemirror_fetch, { method:'post', body:arraybuf })
}

let history = sessionStorage.getItem('history')
if(history) {
    codeMirror.getDoc().setHistory(JSON.parse(history))
}

document.body.style.visibility = ''
codeMirror.focus()

let cursor = sessionStorage.getItem('cursor')
if(cursor) {
    codeMirror.getDoc().setCursor(JSON.parse(cursor))
}            
setInterval(function(e) {
    sessionStorage.setItem('cursor', JSON.stringify(codeMirror.getDoc().getCursor()))
}, 50)

let scrollpos = sessionStorage.getItem('scrollpos')
if(scrollpos) {
    codeMirror.getScrollerElement().scrollTo(0, scrollpos)
}            
setInterval(function(e) {
    sessionStorage.setItem('scrollpos', codeMirror.getScrollerElement().scrollTop)
}, 50)

</script>

<script type="module">
let range = (start, stop, step) => {
    if (stop === undefined) {
        stop = start;
        start = 0;
    }
    if (step === undefined) {
        step = 1;
    }
    if ((step > 0 && start >= stop) || (step < 0 && start <= stop)) {
        return [];
    }
    var result = [];
    for (let i = start; step > 0 ? i < stop : i > stop; i += step) {
        result.push(i);
    }
    return result;
};
export let width = 200;
export let height = 200;
export const init_grid = () => {
    return range(height).map(() => {
        return range(width).map(() => {
            return Math.random() > 0.5;
        });
    });
};
export const at = (grid, y, x) => {
    if (y < 0 || x < 0)
        return false;
    if (y >= height || x >= width)
        return false;
    return grid[y][x];
};
export const step = (grid) => {
    return grid.map((row, y) => {
        return row.map((alive, x) => {
            let atari = 0;
            if (at(grid, y - 1, x - 1))
                atari += 1;
            if (at(grid, y - 1, x + 0))
                atari += 1;
            if (at(grid, y - 1, x + 1))
                atari += 1;
            if (at(grid, y + 0, x - 1))
                atari += 1;
            if (at(grid, y + 0, x + 1))
                atari += 1;
            if (at(grid, y + 1, x - 1))
                atari += 1;
            if (at(grid, y + 1, x + 0))
                atari += 1;
            if (at(grid, y + 1, x + 1))
                atari += 1;
            if (alive && atari < 2) {
                return false;
            }
            if (alive && (atari === 2 || atari === 3)) {
                return true;
            }
            if (alive && atari > 3) {
                return false;
            }
            if (!alive && atari === 3) {
                return true;
            }
            return alive;
        });
    });
};
export const canvas = () => {
    let canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    canvas.style.position = 'absolute';
    canvas.style.top = '0';
    canvas.style.right = '1.5%';
    canvas.style.border = '2px solid black';
    canvas.style.width = '40%';
    canvas.style.imageRendering = 'pixelated';
    document.body.append(canvas);
    return canvas;
};
export const animate = (canvas) => {
    tick(canvas);
    return setTimeout(() => animate(canvas), 1000 / 60);
};
export const pixel = (canvas, x, y, alive) => {
    let c = canvas.getContext('2d');
    if (c instanceof CanvasRenderingContext2D) {
        c.fillStyle = alive ? 'yellow' : 'black';
        c.fillRect(x, y, 1, 1);
    }
};
export let grid = init_grid();
export const tick = (canvas) => {
    grid = step(grid);
    return grid.forEach((row, y) => {
        return row.forEach((alive, x) => {
            return pixel(canvas, x, y, alive);
        });
    });
};
export const main = () => {
    return animate(canvas());
};

main()
</script>



<canvas width="200" height="200" style="position: absolute; top: 0px; right: 1.5%; border: 2px solid black; width: 40%; image-rendering: pixelated;"></canvas></body></html>